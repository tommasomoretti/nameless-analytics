{
    "exportFormatVersion": 2,
    "exportTime": "2025-12-27 10:54:00",
    "containerVersion": {
        "path": "accounts/6000752942/containers/47093634/versions/626",
        "accountId": "6000752942",
        "containerId": "47093634",
        "containerVersionId": "626",
        "name": "Nameless Analytics Server-side basic template",
        "container": {
            "path": "accounts/6000752942/containers/47093634",
            "accountId": "6000752942",
            "containerId": "47093634",
            "name": "Server-side",
            "publicId": "GTM-KQG9ZNG",
            "usageContext": [
                "SERVER"
            ],
            "fingerprint": "1741248743705",
            "tagManagerUrl": "https://tagmanager.google.com/#/container/accounts/6000752942/containers/47093634/workspaces?apiLink=container",
            "features": {
                "supportUserPermissions": true,
                "supportEnvironments": true,
                "supportWorkspaces": true,
                "supportGtagConfigs": false,
                "supportBuiltInVariables": true,
                "supportClients": true,
                "supportFolders": true,
                "supportTags": true,
                "supportTemplates": true,
                "supportTriggers": true,
                "supportVariables": true,
                "supportVersions": true,
                "supportZones": true,
                "supportTransformations": true
            },
            "tagIds": [
                "GTM-KQG9ZNG"
            ],
            "taggingServerUrls": [
                "https://gtm.tommasomoretti.com",
                "https://gtm.namelessanalytics.com"
            ]
        },
        "variable": [
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "variableId": "154",
                "name": "NA - User cookie",
                "type": "sgtmk",
                "parameter": [
                    {
                        "type": "BOOLEAN",
                        "key": "decodeCookie",
                        "value": "true"
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "name",
                        "value": "na_u"
                    }
                ],
                "fingerprint": "1766832638808",
                "parentFolderId": "156",
                "formatValue": {}
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "variableId": "155",
                "name": "NA - Session cookie",
                "type": "sgtmk",
                "parameter": [
                    {
                        "type": "BOOLEAN",
                        "key": "decodeCookie",
                        "value": "false"
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "name",
                        "value": "na_s"
                    }
                ],
                "fingerprint": "1766832638808",
                "parentFolderId": "156",
                "formatValue": {}
            }
        ],
        "folder": [
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "folderId": "156",
                "name": "Nameless Analytics",
                "fingerprint": "1766832633632"
            }
        ],
        "builtInVariable": [
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "CONTAINER_VERSION",
                "name": "Container Version"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "DEBUG_MODE",
                "name": "Debug Mode"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "RANDOM_NUMBER",
                "name": "Random Number"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "CONTAINER_ID",
                "name": "Container ID"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "EVENT_NAME",
                "name": "Event Name"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "REQUEST_PATH",
                "name": "Request Path"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "REQUEST_METHOD",
                "name": "Request Method"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "CLIENT_NAME",
                "name": "Client Name"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "QUERY_STRING",
                "name": "Query String"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "type": "VISITOR_REGION",
                "name": "Visitor Region"
            }
        ],
        "fingerprint": "1766832714359",
        "tagManagerUrl": "https://tagmanager.google.com/#/versions/accounts/6000752942/containers/47093634/versions/626?apiLink=version",
        "customTemplate": [
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "templateId": "47",
                "name": "Nameless Analytics | SS | Client tag",
                "fingerprint": "1766509611415",
                "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"CLIENT\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"Nameless Analytics | SS | Client tag\",\n  \"brand\": {\n    \"id\": \"brand_dummy\",\n    \"displayName\": \"Nameless Analytics\",\n    \"thumbnail\": \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAfQAAAH0CAYAAADL1t+KAAAAAXNSR0IArs4c6QAAAHhlWElmTU0AKgAAAAgABAEaAAUAAAABAAAAPgEbAAUAAAABAAAARgEoAAMAAAABAAIAAIdpAAQAAAABAAAATgAAAAAAAAAkAAAAAQAAACQAAAABAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAfSgAwAEAAAAAQAAAfQAAAAANGC8/AAAAAlwSFlzAAAFiQAABYkBbWid+gAALlxJREFUeAHt3QmUXWd9GPDRLJIsb2jQNtLYKCCW4IQ1AZqmtCElkNBS4CQpnHCAOiHHgcMWA8Z2vG9gCCkQQkgCNFAKJJgUOC00hHBamgJtIWURgSDwIGmk0WILL7Kl0cyo/2sbaSzNvHnz3n333ft9vzlHR2/u8n3//+970v99d3sDA34IECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBAgAABAgQIECBQkcCKivrRDYFSBTZv3vzl48ePP7XURktobMWKFev37NlzsISm7mtibGzs38eLny+rvbLaCfuvR66PL6u9prYTDm+empr6eFPjTyXujRs3PmNwcPDmVPLpNI/hTne0HwEClQg8Mnp5ciU9LaOT4oNLbL45/mT9f0g4XBsGn4g/c/HHT58Eopg/JLqu3b+TqjkGq+5QfwQIJCFwfsxOv5hEJt0l8ZObNm16SXdN2JtAOQIKejmOWiGQnUDMTi+IpKezS/yUhMPh0lg0dMpivxKoXEBBr5xchwSSEdgQmXwpmWw6T+RRca3DhZ3vbk8C5Qgo6OU4aoVArgLFhXFHck1+Xt5vitdZX08wz8LLPgko6H2C1y2BRASKi5G+mkgu3aTx8DiX/vJuGrAvgW4FFPRuBe1PgMATg+Ce3BniXPolYTCSu4P8+yegoPfPXs8EUhFYE1e8fyOVZLrI42HxfISLutjfrgS6ElDQu+KzMwEChUDMTp8Uf92du0Z8sHnjtm3bVuXuIP/+CCjo/XHXK4HUBFZGUf9Oakl1kM/44cOHX9nBfnYh0LWAgt41oQYIECgEYnb6xPhzZ+4a8cHm9Vu3bl2du4P8qxdQ0Ks31yOBVAWG4hGct6aaXLt5xYeasenp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ividAAECBDoWWLNmzZ/EzsWXt/ipWEBBrxhcdwQIEEhZYMeOHcXXql6fco51zU1Br+vIiIsAAQINFdi7d+8HIvRbGxp+Y8NW0Bs7dAInQIBAbQWOxRXv19Y2ukQDU9ATHVhpESBAoJ8C8cUtH4r+v9fPGHLrW0HPbcTlS4AAgWoEZuMWtqur6UovhYCC7n1AgAABAj0R2LNnz0ej4W/3pHGNniYwfNqSdBd8Oz4tnlun9OIc00zZ8USO3402j5TdbrftxZWvc922MX//sNsRua6Zv6wOr1euXFnqmEaOE5HXN+uQ2/wY4isziyuZ/RBYSmAu/q1eFe/jv1xqQ+u7F1jRfRNaIECAAAECiwqsGBsbuyzWnrHoFlYQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAAAECBAgQIECAQLME/j+dHohhvivoygAAAABJRU5ErkJggg\\u003d\\u003d\"\n  },\n  \"description\": \"A highly customizable GTM custom template designed to claim requests from Nameless Analytics Client-side tracker tag and Nameless Analytics Streaming protocol.\",\n  \"containerContexts\": [\n    \"SERVER\"\n  ]\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[\n  {\n    \"type\": \"LABEL\",\n    \"name\": \"event_data_title\",\n    \"displayName\": \"\\u003cb\\u003eData\\u003c/br\\u003e\"\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"user_data\",\n    \"displayName\": \"User data\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"add_user_parameters\",\n        \"checkboxText\": \"Add/override user level parameters\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"user_params_to_add\",\n            \"displayName\": \"User parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_date$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_date parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_source$).*\"\n                    ],\n                    \"enablingConditions\": [],\n                    \"errorMessage\": \"Can\\u0027t add/override user_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_tld_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_tld_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_channel_grouping parameter.\",\n                    \"enablingConditions\": []\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_first_session_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add user_first_session_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_last_session_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_last_session_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add user_id parameter. Add the user ID in the field below.\"\n                  }\n                ]\n              },\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param value\",\n                \"name\": \"param_value\",\n                \"type\": \"TEXT\",\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"add_user_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Add or override user parameters to the request in user_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved user parameters: \\u003c/br\\u003e \\n• user_date \\u003c/br\\u003e \\n• user_id \\u003c/br\\u003e \\n• user_channel_grouping \\u003c/br\\u003e \\n• user_source \\u003c/br\\u003e \\n• user_tld_source \\u003c/br\\u003e \\n• user_campaign \\u003c/br\\u003e \\n• user_campaign_id \\u003c/br\\u003e \\n• user_campaign_content \\u003c/br\\u003e \\n• user_campaign_term \\u003c/br\\u003e \\n• user_device_type \\u003c/br\\u003e \\n• user_country \\u003c/br\\u003e \\n• user_language \\u003c/br\\u003e \\n• user_first_session_timestamp \\u003c/br\\u003e\\n• user_last_session_timestamp \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"displayName\": \"User parameters\"\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"remove_user_parameters\",\n        \"checkboxText\": \"Remove user level parameters\",\n        \"simpleValueType\": true,\n        \"displayName\": \"\",\n        \"help\": \"Remove user parameters from the request in user_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved user parameters: \\u003c/br\\u003e \\n• user_date \\u003c/br\\u003e \\n• user_id \\u003c/br\\u003e \\n• user_channel_grouping \\u003c/br\\u003e \\n• user_source \\u003c/br\\u003e \\n• user_tld_source \\u003c/br\\u003e \\n• user_campaign \\u003c/br\\u003e \\n• user_campaign_id \\u003c/br\\u003e \\n• user_campaign_content \\u003c/br\\u003e \\n• user_campaign_term \\u003c/br\\u003e \\n• user_device_type \\u003c/br\\u003e \\n• user_country \\u003c/br\\u003e \\n• user_language \\u003c/br\\u003e \\n• user_first_session_timestamp \\u003c/br\\u003e\\n• user_last_session_timestamp \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"alwaysInSummary\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"user_params_to_remove\",\n            \"displayName\": \"User parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_date$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_date parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_tld_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_tld_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_campaign_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_first_session_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_first_session_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_last_session_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_last_session_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove user_id parameter. Override the user ID in the field above.\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"remove_user_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"session_data\",\n    \"displayName\": \"Session data\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"override_user_id\",\n        \"checkboxText\": \"Add/override User ID\",\n        \"simpleValueType\": true,\n        \"displayName\": \"Session parameters\",\n        \"help\": \"Add or override User ID to the request in session_data.user_id.\",\n        \"defaultValue\": false,\n        \"alwaysInSummary\": true,\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"user_id\",\n            \"displayName\": \"User ID\",\n            \"simpleValueType\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"valueHint\": \"(not set)\",\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"override_user_id\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"add_session_parameters\",\n        \"checkboxText\": \"Add/override session level parameters\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"session_params_to_add\",\n            \"displayName\": \"Session parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_date$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_date parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_number$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_number parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!cross_domain_session$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override cross_domain_session parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_tld_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_tld_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_campaign_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_browser_name$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_browser_name parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_category$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_landing_page_category parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_landing_page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_landing_page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_category$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_exit_page_category parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_exit_page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_exit_page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_start_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_start_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_end_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_end_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override session_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add user_id parameter. Add the user ID in the field above.\"\n                  }\n                ]\n              },\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param value\",\n                \"name\": \"param_value\",\n                \"type\": \"TEXT\",\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"add_session_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Add or override session parameters to the request in session_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved session parameters: \\u003c/br\\u003e\\n• session_date \\u003c/br\\u003e \\n• session_id \\u003c/br\\u003e\\n• session_number \\u003c/br\\u003e \\n• cross_domain_session \\u003c/br\\u003e \\n• session_channel_grouping \\u003c/br\\u003e \\n• session_source \\u003c/br\\u003e \\n• session_tld_source \\u003c/br\\u003e \\n• session_campaign \\u003c/br\\u003e \\n• session_campaign_id \\u003c/br\\u003e \\n• session_campaign_content \\u003c/br\\u003e \\n• session_campaign_term \\u003c/br\\u003e \\n• session_device_type \\u003c/br\\u003e \\n• session_country \\u003c/br\\u003e \\n• session_language \\u003c/br\\u003e \\n• session_hostname \\u003c/br\\u003e \\n• session_browser_name \\u003c/br\\u003e \\n• session_landing_page_category \\u003c/br\\u003e \\n• session_landing_page_location \\u003c/br\\u003e \\n• session_landing_page_title \\u003c/br\\u003e \\n• session_exit_page_category \\u003c/br\\u003e \\n• session_exit_page_location \\u003c/br\\u003e \\n• session_exit_page_title \\u003c/br\\u003e \\n• session_start_timestamp \\u003c/br\\u003e \\n• session_end_timestamp \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"displayName\": \"\"\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"remove_session_parameters\",\n        \"checkboxText\": \"Remove session level parameters\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"session_params_to_remove\",\n            \"displayName\": \"Session parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_date$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_date parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_number$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_number parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!cross_domain_session$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove cross_domain_session parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_tld_source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_tld_source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_campaign_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_browser_name$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_browser_name parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_category$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_landing_page_category parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_landing_page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_landing_page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_landing_page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_category$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_exit_page_category parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_exit_page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_exit_page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_exit_page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_start_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_start_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_end_timestamp$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_end_timestamp parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!session_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t remove session_id parameter.\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"remove_session_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Remove session parameters from the request in session_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved session parameters: \\u003c/br\\u003e\\n• session_date \\u003c/br\\u003e \\n• session_id \\u003c/br\\u003e\\n• session_number \\u003c/br\\u003e \\n• cross_domain_session \\u003c/br\\u003e \\n• session_channel_grouping \\u003c/br\\u003e \\n• session_source \\u003c/br\\u003e \\n• session_tld_source \\u003c/br\\u003e \\n• session_campaign \\u003c/br\\u003e \\n• session_campaign_id \\u003c/br\\u003e \\n• session_campaign_content \\u003c/br\\u003e \\n• session_campaign_term \\u003c/br\\u003e \\n• session_device_type \\u003c/br\\u003e \\n• session_country \\u003c/br\\u003e \\n• session_language \\u003c/br\\u003e \\n• session_hostname \\u003c/br\\u003e \\n• session_browser_name \\u003c/br\\u003e \\n• session_landing_page_category \\u003c/br\\u003e \\n• session_landing_page_location \\u003c/br\\u003e \\n• session_landing_page_title \\u003c/br\\u003e \\n• session_exit_page_category \\u003c/br\\u003e \\n• session_exit_page_location \\u003c/br\\u003e \\n• session_exit_page_title \\u003c/br\\u003e \\n• session_start_timestamp \\u003c/br\\u003e \\n• session_end_timestamp \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"displayName\": \"\"\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"event_data\",\n    \"displayName\": \"Event data\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"add_event_parameters\",\n        \"checkboxText\": \"Add/override event level parameters\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"event_params_to_add\",\n            \"displayName\": \"Event parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!event_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override event_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_hostname_protocol$).*\"\n                    ],\n                    \"enablingConditions\": [],\n                    \"errorMessage\": \"Can\\u0027t add/override page_hostname_protocol parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_fragment$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_fragment parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_query$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_query parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_extension$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_extension parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_referrer$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_referrer parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_status_code$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_status_code parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!cs_container_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override cs_container_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_agent$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_agent parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!browser_name$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override browser_name parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"enablingConditions\": [],\n                    \"args\": [\n                      \"^(?!browser_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override browser_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override browser_version parameter.\",\n                    \"args\": [\n                      \"^(?!browser_version$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!device_vendor$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override device_vendor parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override device_model parameter.\",\n                    \"args\": [\n                      \"^(?!device_model$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override os_name parameter.\",\n                    \"args\": [\n                      \"^(?!os_name$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!os_version$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override os_version parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!screen_size$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override screen_size parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!viewport_size$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override viewport_size parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!city$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override city parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!ss_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override ss_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!ss_container_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override ss_container_id parameter.\"\n                  }\n                ]\n              },\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param value\",\n                \"name\": \"param_value\",\n                \"type\": \"TEXT\",\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"add_event_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Add or override event parameters to the request in event_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved event parameters: \\u003c/br\\u003e \\n• event_type \\u003c/br\\u003e \\n• channel_grouping \\u003c/br\\u003e \\n• source \\u003c/br\\u003e \\n• campaign \\u003c/br\\u003e \\n• campaign_id \\u003c/br\\u003e \\n• campaign_term \\u003c/br\\u003e \\n• campaign_content \\u003c/br\\u003e \\n• page_id \\u003c/br\\u003e \\n• page_title \\u003c/br\\u003e \\n• page_hostname_protocol \\u003c/br\\u003e \\n• page_hostname \\u003c/br\\u003e \\n• page_location \\u003c/br\\u003e \\n• page_fragment \\u003c/br\\u003e \\n• page_query \\u003c/br\\u003e \\n• page_extension \\u003c/br\\u003e \\n• page_referrer \\u003c/br\\u003e \\n• page_language \\u003c/br\\u003e \\n• page_status_code \\u003c/br\\u003e \\n• cs_container_id \\u003c/br\\u003e \\n• user_agent \\u003c/br\\u003e \\n• browser_name \\u003c/br\\u003e \\n• browser_language \\u003c/br\\u003e \\n• browser_version \\u003c/br\\u003e \\n• device_type \\u003c/br\\u003e \\n• device_vendor \\u003c/br\\u003e \\n• device_model \\u003c/br\\u003e \\n• os_name \\u003c/br\\u003e \\n• os_version \\u003c/br\\u003e \\n• screen_size \\u003c/br\\u003e \\n• viewport_size \\u003c/br\\u003e \\n• country \\u003c/br\\u003e \\n• city \\u003c/br\\u003e \\n• ss_hostname \\u003c/br\\u003e \\n• ss_container_id \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"displayName\": \"Event parameters\"\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"remove_event_parameters\",\n        \"checkboxText\": \"Remove event level parameters\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"event_params_to_remove\",\n            \"displayName\": \"Event parameters\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Param name\",\n                \"name\": \"param_name\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueHint\": \"(not set)\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!event_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override event_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!channel_grouping$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override channel_grouping parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!source$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override source parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_term$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_term parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!campaign_content$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override campaign_content parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_title$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_title parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_hostname_protocol$).*\"\n                    ],\n                    \"enablingConditions\": [],\n                    \"errorMessage\": \"Can\\u0027t add/override page_hostname_protocol parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_location$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_location parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_fragment$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_fragment parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_query$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_query parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_extension$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_extension parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_referrer$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_referrer parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!page_status_code$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override page_status_code parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!cs_container_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override cs_container_id parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!user_agent$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override user_agent parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!browser_name$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override browser_name parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override browser_name parameter.\",\n                    \"args\": [\n                      \"^(?!browser_name$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"enablingConditions\": [],\n                    \"args\": [\n                      \"^(?!browser_language$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override browser_language parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override browser_version parameter.\",\n                    \"args\": [\n                      \"^(?!browser_version$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!device_type$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override device_type parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!device_vendor$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override device_vendor parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override device_model parameter.\",\n                    \"args\": [\n                      \"^(?!device_model$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"errorMessage\": \"Can\\u0027t add/override os_name parameter.\",\n                    \"args\": [\n                      \"^(?!os_name$).*\"\n                    ]\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!os_version$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override os_version parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!screen_size$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override screen_size parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!viewport_size$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override viewport_size parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!country$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override country parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!city$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override city parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!ss_hostname$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override ss_hostname parameter.\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!ss_container_id$).*\"\n                    ],\n                    \"errorMessage\": \"Can\\u0027t add/override ss_container_id parameter.\"\n                  }\n                ]\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"remove_event_parameters\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Remove event parameters from the request in event_data. If a parameter has the same name, it will be overridden.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nReserved event parameters: \\u003c/br\\u003e \\n• event_type \\u003c/br\\u003e \\n• channel_grouping \\u003c/br\\u003e \\n• source \\u003c/br\\u003e \\n• campaign \\u003c/br\\u003e \\n• campaign_id \\u003c/br\\u003e \\n• campaign_term \\u003c/br\\u003e \\n• campaign_content \\u003c/br\\u003e \\n• page_id \\u003c/br\\u003e \\n• page_title \\u003c/br\\u003e \\n• page_hostname_protocol \\u003c/br\\u003e \\n• page_hostname \\u003c/br\\u003e \\n• page_location \\u003c/br\\u003e \\n• page_fragment \\u003c/br\\u003e \\n• page_query \\u003c/br\\u003e \\n• page_extension \\u003c/br\\u003e \\n• page_referrer \\u003c/br\\u003e \\n• page_language \\u003c/br\\u003e \\n• page_status_code \\u003c/br\\u003e \\n• cs_container_id \\u003c/br\\u003e \\n• user_agent \\u003c/br\\u003e \\n• browser_name \\u003c/br\\u003e \\n• browser_language \\u003c/br\\u003e \\n• browser_version \\u003c/br\\u003e \\n• device_type \\u003c/br\\u003e \\n• device_vendor \\u003c/br\\u003e \\n• device_model \\u003c/br\\u003e \\n• os_name \\u003c/br\\u003e \\n• os_version \\u003c/br\\u003e \\n• screen_size \\u003c/br\\u003e \\n• viewport_size \\u003c/br\\u003e \\n• country \\u003c/br\\u003e \\n• city \\u003c/br\\u003e \\n• ss_hostname \\u003c/br\\u003e \\n• ss_container_id \\u003c/br\\u003e\",\n        \"defaultValue\": false,\n        \"displayName\": \"\"\n      }\n    ]\n  },\n  {\n    \"type\": \"LABEL\",\n    \"name\": \"settings_title\",\n    \"displayName\": \"\\u003c/br\\u003e\\u003cb\\u003eSettings\\u003c/b\\u003e\"\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"client_settings\",\n    \"displayName\": \"Client settings\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"TEXT\",\n        \"name\": \"endpoint\",\n        \"displayName\": \"Endpoint path\",\n        \"simpleValueType\": true,\n        \"alwaysInSummary\": true,\n        \"valueHint\": \"(not set)\",\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\",\n            \"enablingConditions\": []\n          },\n          {\n            \"type\": \"REGEX\",\n            \"args\": [\n              \"^/.*(?\\u003c!/)$\"\n            ],\n            \"errorMessage\": \"The endpoint path must start with / and must not end with /.\"\n          }\n        ],\n        \"help\": \"The request endpoint path.\\n\\u003c/br\\u003e\\u003c/br\\u003e\\nThe endpoint path must start with / and must not end with /.\"\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"add_authorized_domains\",\n        \"checkboxText\": \"Accept requests from authorized domains only\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"authorized_domains_list\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Domain name\",\n                \"name\": \"authorized_domain\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^([a-zA-Z0-9-]+\\\\.)+[a-zA-Z]{2,}$\"\n                    ],\n                    \"errorMessage\": \"The URL must not start with http:// or https://, must not end with /, and must contain a valid domain.\"\n                  }\n                ],\n                \"valueHint\": \"(not set)\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"displayName\": \"Authorized domains\",\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"add_authorized_domains\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ],\n        \"alwaysInSummary\": true,\n        \"help\": \"Authorized domains from which to accept requests.  \\u003c/br\\u003e\\u003c/br\\u003e The URL must start with https:/, must not end with /, and contain a valid domain.\"\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"add_banned_ips\",\n        \"checkboxText\": \"Reject requests by IP\",\n        \"simpleValueType\": true,\n        \"alwaysInSummary\": true,\n        \"help\": \"Reject requests by IP.\",\n        \"subParams\": [\n          {\n            \"type\": \"SIMPLE_TABLE\",\n            \"name\": \"banned_ips_list\",\n            \"simpleTableColumns\": [\n              {\n                \"defaultValue\": \"\",\n                \"displayName\": \"Internet Protocol address\",\n                \"name\": \"banned_ip\",\n                \"type\": \"TEXT\",\n                \"isUnique\": true,\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  },\n                  {\n                    \"type\": \"REGEX\",\n                    \"args\": [\n                      \"^(?!192\\\\.168\\\\.0\\\\.1$)(?!2001:db8::1$)(?:(?:\\\\d{1,3}\\\\.){3}\\\\d{1,3}|(?:[A-Fa-f0-9]{1,4}:){1,7}[A-Fa-f0-9]{1,4}|::1)$\"\n                    ],\n                    \"errorMessage\": \"The IP address you entered is not valid. Please make sure it is in the correct format (IPv4 or IPv6).\"\n                  }\n                ],\n                \"valueHint\": \"(not set)\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"displayName\": \"Banned IPs\",\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"add_banned_ips\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ]\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"bq_settings\",\n    \"displayName\": \"Google BigQuery settings\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"TEXT\",\n        \"name\": \"bq_project_id\",\n        \"displayName\": \"Google BigQuery project ID\",\n        \"simpleValueType\": true,\n        \"valueHint\": \"(not set)\",\n        \"help\": \"Google Cloud project ID for BigQuery.\",\n        \"alwaysInSummary\": true,\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\"\n          }\n        ],\n        \"enablingConditions\": []\n      },\n      {\n        \"type\": \"TEXT\",\n        \"name\": \"bq_dataset_id\",\n        \"displayName\": \"Google BigQuery dataset ID\",\n        \"simpleValueType\": true,\n        \"valueHint\": \"(not set)\",\n        \"help\": \"BigQuery dataset ID.\",\n        \"alwaysInSummary\": true,\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\"\n          }\n        ],\n        \"enablingConditions\": []\n      },\n      {\n        \"type\": \"TEXT\",\n        \"name\": \"bq_table_id\",\n        \"displayName\": \"Google BigQuery table ID\",\n        \"simpleValueType\": true,\n        \"valueHint\": \"(not set)\",\n        \"help\": \"BigQuery table ID. \\n\\u003cbr\\u003e\\u003cbr\\u003e\\n\\u003cb\\u003eCreate the table before start sending events.\\u003c/b\\u003e\",\n        \"alwaysInSummary\": true,\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\"\n          }\n        ],\n        \"enablingConditions\": []\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"session_settings\",\n    \"displayName\": \"Session settings\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"change_cookie_prefix\",\n        \"checkboxText\": \"Change user and session cookie prefix\",\n        \"simpleValueType\": true,\n        \"displayName\": \"\",\n        \"help\": \"Override the default user and session cookie name.\",\n        \"defaultValue\": false,\n        \"alwaysInSummary\": true,\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"cookie_prefix\",\n            \"displayName\": \"Cookie prefix\",\n            \"simpleValueType\": true,\n            \"valueHint\": \"(not set)\",\n            \"help\": \"\",\n            \"alwaysInSummary\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ],\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"change_cookie_prefix\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"change_default_session_duration\",\n        \"checkboxText\": \"Change default session duration\",\n        \"simpleValueType\": true,\n        \"displayName\": \"\",\n        \"help\": \"Override the default duration (30 min) of the session cookie.\",\n        \"defaultValue\": false,\n        \"alwaysInSummary\": true,\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"session_max_age\",\n            \"displayName\": \"Session duration\",\n            \"simpleValueType\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"change_default_session_duration\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ],\n            \"alwaysInSummary\": true,\n            \"valueUnit\": \"min\",\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              },\n              {\n                \"type\": \"POSITIVE_NUMBER\"\n              },\n              {\n                \"type\": \"NUMBER\"\n              }\n            ],\n            \"valueHint\": \"(not set)\"\n          }\n        ]\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"advanced_settings\",\n    \"displayName\": \"Advanced settings\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"send_data_to_custom_endpoint\",\n        \"checkboxText\": \"Send data to custom endpoint\",\n        \"simpleValueType\": true,\n        \"displayName\": \"\",\n        \"help\": \"Send data to custom endpoint, via POST request in JSON format.\",\n        \"defaultValue\": false,\n        \"alwaysInSummary\": true,\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"custom_request_endpoint_path\",\n            \"displayName\": \"Full endpoint domain path\",\n            \"simpleValueType\": true,\n            \"valueHint\": \"(not set)\",\n            \"help\": \"\",\n            \"alwaysInSummary\": true,\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              },\n              {\n                \"type\": \"REGEX\",\n                \"args\": [\n                  \"^https:\\\\/\\\\/(?:[a-zA-Z0-9-]+\\\\.)+[a-zA-Z]{2,}(?::\\\\d{2,5})?(?:\\\\/[A-Za-z0-9\\\\-._~!$\\u0026\\u0027()*+,;\\u003d:@%]*)?(?:\\\\?[A-Za-z0-9\\\\-._~!$\\u0026\\u0027()*+,;\\u003d:@%/?]*)?(?:#[A-Za-z0-9\\\\-._~!$\\u0026\\u0027()*+,;\\u003d:@%/?]*)?$\"\n                ],\n                \"errorMessage\": \"The URL must start with https:// and contain a valid domain name.\"\n              }\n            ],\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"send_data_to_custom_endpoint\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ]\n          },\n          {\n            \"type\": \"CHECKBOX\",\n            \"name\": \"add_custom_request_headers\",\n            \"checkboxText\": \"Add custom request headers\",\n            \"simpleValueType\": true,\n            \"displayName\": \"\",\n            \"help\": \"Add custom request headers.\",\n            \"defaultValue\": false,\n            \"alwaysInSummary\": true,\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"send_data_to_custom_endpoint\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ],\n            \"subParams\": [\n              {\n                \"type\": \"SIMPLE_TABLE\",\n                \"name\": \"custom_request_headers\",\n                \"displayName\": \"Custom request headers\",\n                \"simpleTableColumns\": [\n                  {\n                    \"defaultValue\": \"\",\n                    \"displayName\": \"Header name\",\n                    \"name\": \"header_name\",\n                    \"type\": \"TEXT\",\n                    \"isUnique\": true,\n                    \"valueValidators\": [\n                      {\n                        \"type\": \"NON_EMPTY\"\n                      }\n                    ]\n                  },\n                  {\n                    \"defaultValue\": \"\",\n                    \"displayName\": \"Header value\",\n                    \"name\": \"header_value\",\n                    \"type\": \"TEXT\",\n                    \"valueValidators\": [],\n                    \"isUnique\": false\n                  }\n                ],\n                \"alwaysInSummary\": true,\n                \"enablingConditions\": [\n                  {\n                    \"paramName\": \"add_custom_request_headers\",\n                    \"paramValue\": true,\n                    \"type\": \"EQUALS\"\n                  }\n                ],\n                \"newRowButtonText\": \"Add new header\",\n                \"valueValidators\": [\n                  {\n                    \"type\": \"NON_EMPTY\"\n                  }\n                ]\n              }\n            ]\n          }\n        ]\n      },\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"enable_logs\",\n        \"checkboxText\": \"Enable logs in debug view\",\n        \"simpleValueType\": true,\n        \"alwaysInSummary\": true,\n        \"displayName\": \"\",\n        \"help\": \"Enable logging on GTM debug console.\",\n        \"defaultValue\": true\n      }\n    ],\n    \"help\": \"Lorem ipsum\"\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"credits\",\n    \"displayName\": \"Info\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"LABEL\",\n        \"name\": \"info\",\n        \"displayName\": \"\\u003cb\\u003eNameless Analytics Server-Side client tag\\u003c/b\\u003e\\u003c/br\\u003e\\nBeta version: 1.0. \\n\\u003c/br\\u003e\\nRead more about the \\n\\u003ca href\\u003d\\\"https://github.com/tommasomoretti/nameless-analytics\\\" target\\u003d\\u0027_blank\\u0027 rel\\u003d\\\"noopener\\\"\\u003eNameless Analytics project\\u003c/a\\u003e or the \\u003ca href\\u003d\\\"https://github.com/tommasomoretti/nameless-analytics-server-tag\\\" target\\u003d\\u0027_blank\\u0027 rel\\u003d\\\"noopener\\\"\\u003eServer-side Client Tag\\u003c/a\\u003e.\\n\\u003c/br\\u003e\\nCreated by \\u003ca href\\u003d\\\"https://tommasomoretti.com/?utm_source\\u003dtagmanager.google.com\\u0026utm_medium\\u003dreferral\\u0026utm_campaign\\u003dss_analytics_tag\\\" target\\u003d\\u0027_blank\\u0027 rel\\u003d\\\"noopener\\\"\\u003eTommaso Moretti\\u003c/a\\u003e\\n\\u003c/br\\u003e\\u003c/br\\u003e\"\n      }\n    ]\n  }\n]\n\n\n___SANDBOXED_JS_FOR_SERVER___\n\nconst log = require('logToConsole');\nconst getTimestampMillis = require('getTimestampMillis');\nconst claimRequest = require('claimRequest');\nconst getRequestHeader = require('getRequestHeader');\nconst getRemoteAddress = require('getRemoteAddress');\nconst getRequestBody = require('getRequestBody');\nconst getRequestMethod = require('getRequestMethod');\nconst getRequestPath = require('getRequestPath');\nconst getClientName = require('getClientName');\nconst setResponseHeader = require('setResponseHeader');\nconst setResponseBody = require('setResponseBody');\nconst setResponseStatus = require('setResponseStatus');\nconst returnResponse = require('returnResponse');\nconst runContainer = require('runContainer');\nconst JSON = require('JSON');\nconst Object = require('Object');\nconst getType = require('getType');\nconst makeNumber = require('makeNumber');\nconst generateRandom = require('generateRandom');\nconst getContainerVersion = require('getContainerVersion');\nconst getCookieValues = require('getCookieValues');\nconst setCookie = require('setCookie');\nconst computeEffectiveTldPlusOne = require('computeEffectiveTldPlusOne');\nconst BigQuery = require('BigQuery');\nconst Firestore = require('Firestore');\nconst sendHttpRequest = require('sendHttpRequest');\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n// Request data\nconst endpoint = data.endpoint;\nconst request_origin = getRequestHeader('Origin');\nconst request_ip = getRemoteAddress();\nconst request_method = getRequestMethod();\n\n// Cookie data\nconst user_cookie_name = (data.change_cookie_prefix) ? data.cookie_prefix + '_na_u' : 'na_u';\nconst user_cookie_value = getCookieValues(user_cookie_name)[0];\n\nconst session_cookie_name = (data.change_cookie_prefix) ? data.cookie_prefix + '_na_s' : 'na_s';\nconst session_cookie_value = getCookieValues(session_cookie_name)[0];\n\n// Response data\nvar message;\nvar status_code;\n\n\n// Check request endpoint\nif (getRequestPath() === endpoint) {\n  if (data.enable_logs) { log('NAMELESS ANALYTICS'); }\n  if (data.enable_logs) { log('CLIENT TAG CONFIGURATION'); }\n\n  const event_data = JSON.parse(getRequestBody());\n\n  const event_origin = event_data.event_origin;\n  const event_date = event_data.event_date;\n  const event_name = event_data.event_name;\n  const event_timestamp = event_data.event_timestamp;\n\n  const page_id = event_data.page_id;\n  const page_data_obj = event_data.page_data;\n\n  const event_id = event_data.event_id;\n  const event_data_obj = event_data.event_data;\n\n  // Check request origin, required fields and claim requests\n  if (check_origin()) {\n    if (!check_ip()) {\n\n      if (data.enable_logs) { log('CHECK REQUEST...'); }\n\n      if (request_method === 'POST') {\n\n        // Check required fields\n        const missing_fields = [];\n\n        if (!event_origin) missing_fields.push('event_origin');\n        if (!event_date) missing_fields.push('event_date');\n        if (!event_name) missing_fields.push('event_name');\n        if (!event_timestamp) missing_fields.push('event_timestamp');\n\n        if (!page_id) missing_fields.push('page_id');\n        if (!page_data_obj || Object.keys(page_data_obj).length === 0) missing_fields.push('page_data');\n\n        if (!event_id) missing_fields.push('event_id');\n        if (!event_data_obj || Object.keys(event_data_obj).length === 0) missing_fields.push('event_data');\n\n        let message;\n        let status_code;\n\n        // REFUSE REQUESTS\n        // Check User-Agent header\n        const user_agent = getRequestHeader('User-Agent') || '';\n        const request_user_agent = user_agent.toLowerCase();\n        const bad_agents = [\"curl\", \"wget\", \"python\", \"requests\", \"httpie\", \"go-http-client\", \"java\", \"okhttp\", \"libwww\", \"perl\", \"axios\", \"node\", \"fetch\", \"bot\", \"crawler\", \"spider\", \"scraper\", \"headless\", \"phantomjs\", \"selenium\", \"puppeteer\", \"playwright\"];\n\n        // Empty UA\n        if (request_user_agent === '') {\n          message = '🔴 Missing User-Agent header.';\n          status_code = 403;\n\n          if (data.enable_logs) { log(message); }\n          claim_request({ event_name: event_name }, status_code, message);\n          return;\n        }\n\n        // UA Bots\n        for (var i = 0; i < bad_agents.length; i++) {\n          if (request_user_agent.indexOf(bad_agents[i]) !== -1) {\n            message = '🔴 Invalid User-Agent header value. Request from bot.';\n            status_code = 403;\n            if (data.enable_logs) { log(message); }\n\n            claim_request({ event_name: event_name }, status_code, message);\n            return;\n          }\n        }\n\n        // Check event origin \n        if (event_origin !== 'Website') {\n          message = '🔴 Invalid event_origin parameter value. Accepted values: Website.';\n          status_code = 403;\n\n          if (data.enable_logs) { log(message); }\n          claim_request({ event_name: event_name }, status_code, message);\n          // If some required parameter is missing \n        } else if (missing_fields.length > 0 && event_name != 'get_user_data') {\n          message = '🔴 Missing required parameters: '.concat(missing_fields.join(', '));\n          if (data.enable_logs) { log(message); }\n          status_code = 403;\n\n          claim_request({ event_name: event_name }, status_code, message);\n\n          // If user cookie is missing\n        } else if (event_data.event_origin == 'Website' && event_data.event_name != 'page_view' && event_data.event_name != 'get_user_data' && user_cookie_value === undefined) {\n          message = '🔴 Website orphan event. Trigger a page_view event first to create a new user and a new session';\n          status_code = 403;\n\n          if (data.enable_logs) { log(message); }\n          claim_request({ event_name: event_name }, status_code, message);\n\n          // If session cookie is missing\n        } else if (event_data.event_origin == 'Website' && event_data.event_name != 'page_view' && event_data.event_name != 'get_user_data' && session_cookie_value === undefined) {\n          message = '🔴 Website orphan event. Trigger a page_view event first to create a new session';\n          status_code = 403;\n\n          if (data.enable_logs) { log(message); }\n          claim_request({ event_name: event_name }, status_code, message);\n\n          // If user or session cookie is missing for get_user_data requests\n        } else if (event_name == 'get_user_data' && (user_cookie_value === undefined || session_cookie_value === undefined)) {\n          if (data.enable_logs) { log('👉 Request from get_user_data event'); }\n\n          if (data.enable_logs) { log('CHECK COOKIES...'); }\n\n          if (user_cookie_value === undefined) {\n            message = '🔴 User cookie not found. No cross-domain link decoration will be applied';\n            status_code = 403;\n\n            if (data.enable_logs) { log(message); }\n            claim_request(set_ids_get_user_data(), status_code, message);\n          } else if (session_cookie_value === undefined) {\n            message = '🔴 Session cookie not found. No cross-domain link decoration will be applied';\n            status_code = 403;\n\n            if (data.enable_logs) { log(message); }\n            claim_request(set_ids_get_user_data(), status_code, message);\n          }\n\n          // CLAIM REQUESTS \n        } else {\n          // Claim get user data requests\n          if (event_name == 'get_user_data') {\n            if (data.enable_logs) { log('🟢 Request correct, user and session cookie found. Cross-domain link decoration will be applied'); }\n\n            message = '🟢 Request claimed successfully';\n            status_code = 200;\n\n            if (data.enable_logs) { log('CLAIM REQUEST...'); }\n            claim_request(set_ids_get_user_data(), status_code, message);\n\n          } else {\n            // Claim standard requests\n            if (data.enable_logs) { log('🟢 Request correct'); }\n\n            if (data.enable_logs) { log('CLAIM REQUEST...'); }\n            claim_request(build_payload(set_ids(event_data)), null, '');\n          }\n        }\n      } else {\n        if (data.enable_logs) { log('CHECK REQUEST...'); }\n\n        // RETURN RESPONSE ERRORS\n        message = '🔴 Request method not correct';\n        status_code = 403;\n\n        if (data.enable_logs) { log(message); }\n        claim_request({ event_name: event_name }, status_code, message);\n      }\n    } else {\n      if (data.enable_logs) { log('CHECK REQUEST...'); }\n\n      // RETURN RESPONSE ERRORS\n      message = '🔴 Request IP not authorized';\n      status_code = 403;\n\n      if (data.enable_logs) { log(message); }\n      claim_request({ event_name: event_name }, status_code, message);\n    }\n  } else {\n    if (data.enable_logs) { log('CHECK REQUEST...'); }\n\n    // RETURN RESPONSE ERRORS\n    message = '🔴 Request origin not authorized';\n    status_code = 403;\n\n    if (data.enable_logs) { log(message); }\n    claim_request({ event_name: event_name }, status_code, message);\n  }\n}\n\n\n// Check request origin\nfunction check_origin() {\n  const authorized_domains_list = (data.add_authorized_domains) ? data.authorized_domains_list : [{ authorized_domain: request_origin }];\n  var authorized_domains = '';\n\n  for (let i = 0; i < authorized_domains_list.length; i++) {\n    const authorized_domains_tld = computeEffectiveTldPlusOne(authorized_domains_list[i].authorized_domain);\n    authorized_domains = authorized_domains.concat(', ', authorized_domains_tld);\n  }\n\n  if (data.enable_logs) { log('👉 Endpoint:', endpoint); }\n  if (data.enable_logs) { log('👉 Authorized origins:', (data.add_authorized_domains) ? authorized_domains.slice(2) : ' All'); }\n\n  for (let i = 0; i < authorized_domains_list.length; i++) {\n    if (computeEffectiveTldPlusOne(request_origin) == computeEffectiveTldPlusOne(authorized_domains_list[i].authorized_domain)) {\n      return true;\n    }\n  }\n}\n\n\n// Check request ip\nfunction check_ip() {\n  const banned_ip_list = (data.add_banned_ips) ? data.banned_ips_list : [{ banned_ip: null }];\n  var banned_ips = '';\n\n  for (let i = 0; i < banned_ip_list.length; i++) {\n    banned_ips = banned_ips.concat(', ', banned_ip_list[i].banned_ip);\n  }\n\n  if (data.enable_logs) { log('👉 Unauthorized IPs:', (data.add_banned_ips) ? banned_ips.slice(2) : 'None'); }\n\n  for (let i = 0; i < banned_ip_list.length; i++) {\n    if (request_ip == banned_ip_list[i].banned_ip) {\n      return true;\n    }\n  }\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Handle ids for get_user_data requests (For cross-domain only)\nfunction set_ids_get_user_data() {\n  const client_id = user_cookie_value || 'undefined';\n  const session_id = session_cookie_value || 'undefined';\n  const page_id = (session_cookie_value) ? session_cookie_value.split('-')[1] : 'undefined';\n\n  const event_data = {\n    event_name: 'get_user_data',\n    client_id: client_id,\n    session_id: session_id.split('-')[0] || 'undefined',\n    page_id: page_id\n  };\n\n  // if(data.enable_logs){log('👉 Client ID: ' + event_data.client_id);} \n  // if(data.enable_logs){log('👉 Session ID: ' + event_data.session_id);} \n\n  return event_data;\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Handle ids for standard requests\nfunction set_ids(event_data) {\n  if (event_data.event_origin == 'Website') {\n    // if(data.enable_logs){log('👉 Request from website');}\n    if (data.enable_logs) { log('👉 Event name: ', event_data.event_name); }\n\n    const page_id = event_data.page_id;\n    const event_id = event_data.event_id;\n    const cross_domain_id = event_data.event_data.cross_domain_id;\n\n    // Cross-domain request\n    if (cross_domain_id) {\n      const cross_domain_client_id = cross_domain_id.split('_')[0];\n      const cross_domain_session_id = cross_domain_id;\n\n      if (data.enable_logs) { log('👉 Cross-domain visit'); }\n\n      // With an active session\n      if (session_cookie_value) {\n        // With different session id\n        if (cross_domain_session_id != session_cookie_value.split('-')[0]) {\n          event_data.client_id = cross_domain_client_id;\n          event_data.session_id = cross_domain_session_id;\n          event_data.page_id = cross_domain_session_id + '-' + page_id;\n          event_data.event_id = cross_domain_session_id + '-' + event_id;\n\n          if (data.enable_logs) { log('👉 Create new client_id: ', cross_domain_client_id + ' and new session_id: ', cross_domain_session_id); }\n\n          // With the same session id   \n        } else {\n          const old_client_id = user_cookie_value;\n          const old_session_id = session_cookie_value.split('-')[0];\n\n          event_data.client_id = old_client_id;\n          event_data.session_id = old_session_id;\n          event_data.page_id = old_session_id + '-' + page_id;\n          event_data.event_id = old_session_id + '-' + event_id;\n\n          if (data.enable_logs) { log('👉 Same client_id, same session_id'); }\n          if (data.enable_logs) { log('👉 Extend cookies max-age'); }\n        }\n\n        // Without an active session         \n      } else {\n        event_data.client_id = cross_domain_client_id;\n        event_data.session_id = cross_domain_session_id;\n        event_data.page_id = cross_domain_session_id + '-' + page_id;\n        event_data.event_id = cross_domain_session_id + '-' + event_id;\n\n        if (data.enable_logs) { log('👉 Returning user, no active session'); }\n        if (data.enable_logs) { log('👉 Same client_id: ', cross_domain_client_id + ', create new session_id: ', cross_domain_session_id); }\n      }\n\n      // No cross-domain request\n    } else {\n      // New user\n      if (user_cookie_value === undefined) {\n        const new_client_id = generate_alphanumeric();\n        const new_session_id = new_client_id + '_' + generate_alphanumeric();\n\n        event_data.client_id = new_client_id;\n        event_data.session_id = new_session_id;\n        event_data.page_id = new_session_id + '-' + page_id;\n        event_data.event_id = new_session_id + '-' + event_id;\n\n        if (data.enable_logs) { log('👉 New user, no active session'); }\n        if (data.enable_logs) { log('👉 Create new client_id: ', new_client_id + ' and new session_id: ', new_session_id); }\n\n        // Returning user\n      } else if (user_cookie_value != undefined) {\n        // No session cookie\n        if (session_cookie_value === undefined) {\n          const old_client_id = user_cookie_value;\n          const new_session_id = old_client_id + '_' + generate_alphanumeric();\n\n          event_data.client_id = old_client_id;\n          event_data.session_id = new_session_id;\n          event_data.page_id = new_session_id + '-' + page_id;\n          event_data.event_id = new_session_id + '-' + event_id;\n\n          if (data.enable_logs) { log('👉 Returning user, no active session'); }\n          if (data.enable_logs) { log('👉 Same client_id: ', old_client_id + ', create new session_id: ', new_session_id); }\n\n          // Yes session cookie\n        } else {\n          const old_client_id = user_cookie_value;\n          const old_session_id = session_cookie_value.split('-')[0];\n\n          event_data.client_id = old_client_id;\n          event_data.session_id = old_session_id;\n          event_data.page_id = old_session_id + '-' + page_id;\n          event_data.event_id = old_session_id + '-' + event_id;\n\n          if (data.enable_logs) { log('👉 Same client_id, same session_id'); }\n          if (data.enable_logs) { log('👉 Extend cookies max-age'); }\n        }\n      }\n    }\n\n    return event_data;\n\n  }\n}\n\n\n// Generate random alphanumeric ID \nfunction generate_alphanumeric() {\n  var max_length = 15; // Change this to the desired length\n  var chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var alphanumeric_id = '';\n\n  for (var i = 0; i < max_length; i++) {\n    alphanumeric_id += chars.charAt(generateRandom(0, chars.length));\n  }\n\n  return alphanumeric_id;\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Build payload data for standard requests\nfunction build_payload(event_data) {\n  // Add additional info    \n  event_data.event_data.country = getRequestHeader('X-Appengine-Country');\n  event_data.event_data.city = getRequestHeader('X-Appengine-City');\n\n  event_data.gtm_data.ss_hostname = getRequestHeader('Host');\n  event_data.gtm_data.ss_container_id = getContainerVersion().containerId;\n  event_data.gtm_data.ss_tag_name = getClientName();\n  event_data.gtm_data.ss_tag_id = null;\n  event_data.gtm_data.processing_event_timestamp = getTimestampMillis();\n  event_data.gtm_data.content_length = makeNumber(getRequestHeader('content-length'));\n\n\n  // User data\n  // Add or override user ID\n  if (data.override_user_id) {\n    event_data.session_data.user_id = (data.user_id == \"null\") ? null : data.user_id;\n  }\n\n  // Add user data from tag fields\n  if (data.add_user_parameters) {\n    const user_params = data.user_params_to_add;\n\n    if (user_params !== undefined) {\n      for (let i = 0; i < user_params.length; i++) {\n        const param_name = user_params[i].param_name;\n        const param_value = user_params[i].param_value;\n\n        event_data.user_data[param_name] = param_value;\n      }\n    }\n  }\n\n  // Remove user data from tag fields\n  if (data.remove_user_parameters) {\n    const user_params = data.user_params_to_remove;\n\n    if (user_params !== undefined) {\n      for (let i = 0; i < user_params.length; i++) {\n        const param_name = user_params[i].param_name;\n\n        Object.delete(event_data.user_data, param_name);\n      }\n    }\n  }\n\n\n  // Session data\n  // Add session data from tag fields\n  if (data.add_session_parameters) {\n    const session_params = data.session_params_to_add;\n\n    if (session_params !== undefined) {\n      for (let i = 0; i < session_params.length; i++) {\n        const param_name = session_params[i].param_name;\n        const param_value = session_params[i].param_value;\n\n        event_data.session_data[param_name] = param_value;\n      }\n    }\n  }\n\n  // Remove session data from tag fields\n  if (data.remove_session_parameters) {\n    const session_params = data.session_params_to_remove;\n\n    if (session_params !== undefined) {\n      for (let i = 0; i < session_params.length; i++) {\n        const param_name = session_params[i].param_name;\n\n        Object.delete(event_data.session_data, param_name);\n      }\n    }\n  }\n\n\n  // Event data\n  if (event_data.event_data.source) {\n    event_data.event_data.tld_source = (computeEffectiveTldPlusOne(event_data.event_data.source) !== '') ? computeEffectiveTldPlusOne(event_data.event_data.source) : event_data.event_data.source;\n  }\n\n  // Add event data from tag fields\n  if (data.add_event_parameters) {\n    const event_params = data.event_params_to_add;\n\n    if (event_params !== undefined) {\n      for (let i = 0; i < event_params.length; i++) {\n        const param_name = event_params[i].param_name;\n        const param_value = event_params[i].param_value;\n\n        event_data.event_data[param_name] = param_value;\n      }\n    }\n  }\n\n  // Remove event data from tag fields\n  if (data.remove_event_parameters) {\n    const event_params = data.event_params_to_remove;\n\n    if (event_params !== undefined) {\n      for (let i = 0; i < event_params.length; i++) {\n        const param_name = event_params[i].param_name;\n\n        Object.delete(event_data.event_data, param_name);\n      }\n    }\n  }\n\n  return event_data;\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Claim requests\nfunction claim_request(event_data, status_code, message) {\n  claimRequest();\n\n  // For error requests and get_user_data requests\n  if ((status_code === 403 || event_data.event_name == 'get_user_data')) {\n    if (data.enable_logs) { log('TAG EXECUTION STATUS:'); }\n    return_response(event_data, status_code, message);\n\n    // For standard requests\n  } else {\n    // Send data to Firestore\n    send_to_firestore(event_data)\n      // Return response\n      .then((res) => {\n        return_response(event_data, res.status_code, res.message);\n        return res;\n      })\n      // Send data to BigQuery\n      .then((res) => {\n        if (res.status == true) {\n          if (data.enable_logs) { log('SEND EVENT DATA TO GOOGLE BIGQUERY...'); }\n          send_to_bq(event_data);\n\n          if (data.enable_logs && !data.send_data_to_custom_endpoint) { log('TAG EXECUTION STATUS:'); }\n        }\n        return res;\n      })\n      // Send data to custom endpoint\n      .then((res) => {\n        if (res.status == true) {\n          if (data.send_data_to_custom_endpoint) {\n            if (data.enable_logs) { log('SEND EVENT DATA TO CUSTOM ENDPOINT...'); }\n            send_to_custom_endpoint(data.custom_request_endpoint_path, event_data);\n\n            if (data.enable_logs) { log('TAG EXECUTION STATUS:'); }\n          }\n        }\n      });\n  }\n}\n\n\n// Return response\nfunction return_response(event_data, status_code, message) {\n  runContainer(event_data, () => {\n    setResponseStatus(status_code);\n    setResponseHeader('Access-Control-Allow-Credentials', 'true');\n    setResponseHeader('Access-Control-Allow-Origin', request_origin);\n    setResponseHeader('Access-Control-Allow-Methods', 'POST');\n    setResponseHeader('cache-control', 'no-store');\n    setResponseBody(JSON.stringify({\n      status_code: status_code,\n      response: message,\n      data: event_data\n    }));\n\n    returnResponse();\n\n    if (status_code === 403) {\n      if (data.enable_logs) { log('🔴 Request refused.'); }\n    } else {\n      if (data.enable_logs) { log(message); }\n    }\n  });\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Send data to Google Firestore\nfunction send_to_firestore(event_data) {\n  const projectId = data.bq_project_id;\n  const queries = [['client_id', '==', event_data.client_id]];\n  const collection_path = 'users';\n  const document_path = collection_path + '/' + event_data.client_id;\n\n  return Firestore.query(collection_path, queries, { projectId: projectId, limit: 1 })\n    .then((documents) => {\n\n      // REJECT REQUESTS (orphan events) \n      if (event_data.event_name != 'page_view' && documents.length === 0) {\n        message = '🔴 Orphan event. Trigger a page_view event first to create a new user and a new session.';\n        return { status: false, status_code: 403, message: message };\n      } if (event_data.event_name != 'page_view' && !documents[0].data.sessions.some(s => s.session_id === event_data.session_id)) {\n        message = '🔴 Orphan event. Trigger a page_view event first to create a new session.';\n        return { status: false, status_code: 403, message: message };\n      }\n\n      // Set cookies\n      const user_cookie_max_age = 400 * 24 * 60 * 60;\n      const session_cookie_max_age = (makeNumber(data.session_max_age) || 30) * 60;\n\n      set_cookie(user_cookie_name, event_data.client_id, user_cookie_max_age);\n      set_cookie(session_cookie_name, event_data.page_id, session_cookie_max_age);\n\n      // If user does not exist in Firestore\n      if (documents && documents.length === 0) {\n        if (data.enable_logs) { log('SEND EVENT DATA TO GOOGLE FIRESTORE...'); }\n        if (data.enable_logs) { log('👉 User does not exist'); }\n        if (data.enable_logs) { log('👉 Session does not exist'); }\n\n        // Set user and session parameter values for Firestore from current event data\n        const firestore_data = {\n          user_date: event_data.event_date,\n          client_id: event_data.client_id,\n          user_channel_grouping: event_data.event_data.channel_grouping,\n          user_source: event_data.event_data.source,\n          user_tld_source: event_data.event_data.tld_source,\n          user_campaign: event_data.event_data.campaign,\n          user_campaign_id: event_data.event_data.campaign_id,\n          user_campaign_click_id: event_data.event_data.campaign_click_id,\n          user_campaign_term: event_data.event_data.campaign_term,\n          user_campaign_content: event_data.event_data.campaign_content,\n          user_device_type: event_data.event_data.device_type,\n          user_country: event_data.event_data.country,\n          user_language: event_data.event_data.browser_language,\n          user_first_session_timestamp: (event_data.event_name == 'page_view') ? event_data.event_timestamp : 'null',\n          user_last_session_timestamp: (event_data.event_name == 'page_view') ? event_data.event_timestamp : 'null',\n          sessions: [{\n            session_date: event_data.event_date,\n            session_id: event_data.session_id,\n            session_number: 1,\n            cross_domain_session: (event_data.event_data.cross_domain_id) ? 'Yes' : 'No',\n            session_channel_grouping: event_data.event_data.channel_grouping,\n            session_source: event_data.event_data.source,\n            session_tld_source: event_data.event_data.tld_source,\n            session_campaign: event_data.event_data.campaign,\n            session_campaign_id: event_data.event_data.campaign_id,\n            session_campaign_click_id: event_data.event_data.campaign_click_id,\n            session_campaign_term: event_data.event_data.campaign_term,\n            session_campaign_content: event_data.event_data.campaign_content,\n            session_device_type: event_data.event_data.device_type,\n            session_country: event_data.event_data.country,\n            session_language: event_data.event_data.browser_language,\n            session_hostname: event_data.page_data.page_hostname,\n            session_browser_name: event_data.event_data.browser_name,\n            session_landing_page_category: event_data.page_data.page_category,\n            session_landing_page_location: event_data.page_data.page_location,\n            session_landing_page_title: event_data.page_data.page_title,\n            session_exit_page_category: event_data.page_data.page_category,\n            session_exit_page_location: event_data.page_data.page_location,\n            session_exit_page_title: event_data.page_data.page_title,\n            session_start_timestamp: (event_data.event_name == 'page_view') ? event_data.event_timestamp : 'null',\n            session_end_timestamp: event_data.event_timestamp,\n            user_id: event_data.session_data.user_id || null,\n            total_events: 1,\n            total_page_views: 1\n          }]\n        };\n\n        // Add user parameters to Firestore\n        for (let key in event_data.user_data) {\n          if (event_data.user_data.hasOwnProperty(key)) {\n            firestore_data[key] = event_data.user_data[key];\n          }\n        }\n\n        // Add session parameters to Firestore\n        for (let key in event_data.session_data) {\n          if (event_data.session_data.hasOwnProperty(key)) {\n            firestore_data.sessions[0][key] = event_data.session_data[key];\n          }\n        }\n\n        // Send data to Firestore \n        if (data.enable_logs) { log('👉 Payload to send: ', firestore_data); }\n\n        Firestore.write(document_path, firestore_data, { projectId: projectId, merge: true })\n          .then(\n            (id) => { if (data.enable_logs) { log('🟢 User successfully created in Firestore, session successfully added into Firestore'); } },\n            () => {\n              message = '🔴 User or session data not created in Firestore.';\n              status_code = 403;\n\n              if (data.enable_logs) { log(message); }\n              return { status: false, status_code: status_code, message: message };\n            }\n          );\n\n        // Add user parameters to Big Query        \n        for (let key in firestore_data) {\n          if (firestore_data.hasOwnProperty(key) && key !== 'sessions') {\n            event_data.user_data[key] = firestore_data[key];\n          }\n        }\n\n        event_data.user_date = event_data.user_data.user_date;\n\n        Object.delete(event_data.user_data, 'user_date');\n        Object.delete(event_data.user_data, 'client_id');\n\n        // Add session parameters to Big Query \n        event_data.session_data = firestore_data.sessions[0];\n        event_data.session_date = event_data.session_data.session_date;\n\n        Object.delete(event_data.session_data, 'session_date');\n        Object.delete(event_data.session_data, 'session_id');\n\n        // If user exists in Firestore  \n      } else {\n        if (data.enable_logs) { log('SEND EVENT DATA TO GOOGLE FIRESTORE...'); }\n        if (data.enable_logs) { log('👉 User exist'); }\n\n        const firestore_data = documents[0].data;\n        const sessions_data = firestore_data.sessions;\n        const last_session = sessions_data.slice(-1)[0];\n\n        // Update user values in Firestore from current user data if not already exists or has a not null value        \n        const protected_keys = [\n          \"user_date\",\n          \"user_channel_grouping\",\n          \"user_source\",\n          \"user_tld_source\",\n          \"user_campaign\",\n          \"user_campaign_id\",\n          \"user_campaign_click_id\",\n          \"user_campaign_term\",\n          \"user_campaign_content\",\n          \"user_device_type\",\n          \"user_country\",\n          \"user_language\",\n          \"user_first_session_timestamp\",\n          \"user_last_session_timestamp\"\n        ];\n\n        Object.keys(event_data.user_data).forEach(function (key) {\n          const value = event_data.user_data[key];\n\n          if (value == null) { return; }\n          if (protected_keys.indexOf(key) !== -1 && firestore_data[key] != null) { return; }\n\n          if (firestore_data[key] !== value) {\n            firestore_data[key] = value;\n          }\n        });\n\n        // Update last session timestamp of the user\n        if (event_data.session_id != last_session.session_id) {\n          firestore_data.user_last_session_timestamp = event_data.event_timestamp;\n        }\n\n        // Add user parameters to Big Query        \n        for (let key in firestore_data) {\n          if (firestore_data.hasOwnProperty(key) && key !== 'sessions') {\n            event_data.user_data[key] = firestore_data[key];\n          }\n        }\n\n        event_data.user_date = event_data.user_data.user_date;\n\n        Object.delete(event_data.user_data, 'user_date');\n        Object.delete(event_data.user_data, 'client_id');\n\n        // If session doesn't exists in Firestore\n        if (event_data.session_id != last_session.session_id) {\n          if (data.enable_logs) { log('👉 Session does not exist'); }\n\n          // Set new session values for Firestore from current event data\n          var new_session = {\n            session_date: event_data.event_date,\n            session_id: event_data.session_id,\n            session_number: last_session.session_number + 1,\n            cross_domain_session: (event_data.event_data.cross_domain_id) ? 'Yes' : 'No',\n            session_channel_grouping: event_data.event_data.channel_grouping,\n            session_source: event_data.event_data.source,\n            session_tld_source: event_data.event_data.tld_source,\n            session_campaign: event_data.event_data.campaign,\n            session_campaign_id: event_data.event_data.campaign_id,\n            session_campaign_click_id: event_data.event_data.campaign_click_id,\n            session_campaign_term: event_data.event_data.campaign_term,\n            session_campaign_content: event_data.event_data.campaign_content,\n            session_device_type: event_data.event_data.device_type,\n            session_country: event_data.event_data.country,\n            session_language: event_data.event_data.browser_language,\n            session_hostname: event_data.page_data.page_hostname,\n            session_browser_name: event_data.event_data.browser_name,\n            session_landing_page_category: (event_data.page_data.page_category) ? event_data.page_data.page_category : null,\n            session_landing_page_location: event_data.page_data.page_location,\n            session_landing_page_title: event_data.page_data.page_title,\n            session_exit_page_category: (event_data.page_data.page_category) ? event_data.page_data.page_category : null,\n            session_exit_page_location: event_data.page_data.page_location,\n            session_exit_page_title: event_data.page_data.page_title,\n            session_start_timestamp: (event_data.event_name == 'page_view') ? event_data.event_timestamp : null,\n            session_end_timestamp: event_data.event_timestamp,\n            user_id: event_data.session_data.user_id || null,\n            total_events: 1,\n            total_page_views: 1\n          };\n\n          // Add session parameters for Firestore\n          for (let key in event_data.session_data) {\n            if (event_data.session_data.hasOwnProperty(key)) {\n              new_session[key] = event_data.session_data[key];\n            }\n          }\n\n          // Add new session data to Firestore\n          firestore_data.sessions.push(new_session);\n\n          // Send data to Firestore                    \n          if (data.enable_logs) { log('👉 Payload to send: ', firestore_data); }\n\n          Firestore.write(document_path, firestore_data, { projectId: projectId, merge: true })\n            .then(\n              (id) => { if (data.enable_logs) { log('🟢 User already in Firestore, session successfully added into Firestore'); } },\n              () => {\n                message = '🔴 User or session data not added in Firestore.';\n                status_code = 403;\n\n                if (data.enable_logs) { log(message); }\n                return { status: false, status_code: status_code, message: message };\n              }\n            );\n\n          // Add data to BigQuery\n          event_data.session_data = firestore_data.sessions.slice(-1)[0];\n          event_data.session_date = event_data.session_data.session_date;\n\n          Object.delete(event_data.session_data, 'session_date');\n          Object.delete(event_data.session_data, 'session_id');\n\n          // If session exists in Firestore        \n        } else {\n          if (data.enable_logs) { log('👉 Session exist'); }\n\n          // Update session values in Firestore from current session data if not already exists or has a not null value \n          const protected_keys = [\n            \"session_date\",\n            \"session_id\",\n            \"session_number\",\n            \"cross_domain_session\",\n            \"session_channel_grouping\",\n            \"session_source\",\n            \"session_tld_source\",\n            \"session_campaign\",\n            \"session_campaign_id\",\n            \"session_campaign_click_id\",\n            \"session_campaign_term\",\n            \"session_campaign_content\",\n            \"session_device_type\",\n            \"session_country\",\n            \"session_language\",\n            \"session_hostname\",\n            \"session_browser_name\",\n            \"session_landing_page_category\",\n            \"session_landing_page_location\",\n            \"session_landing_page_title\",\n            \"session_exit_page_category\",\n            \"session_exit_page_location\",\n            \"session_exit_page_title\",\n            \"session_start_timestamp\",\n            \"session_end_timestamp\",\n            \"user_id\",\n            \"total_events\",\n            \"total_page_views\"\n          ];\n\n          Object.keys(event_data.session_data).forEach(function (key) {\n            const value = event_data.session_data[key];\n\n            if (value == null) { return; }\n            if (protected_keys.indexOf(key) !== -1 && last_session[key] != null) { return; }\n\n            if (last_session[key] !== value) {\n              last_session[key] = value;\n            }\n          });\n\n          // Update session values in Firestore from current event data\n          last_session.session_exit_page_category = (event_data.page_data.page_category) ? event_data.page_data.page_category : null;\n          last_session.session_exit_page_location = event_data.page_data.page_location;\n          last_session.session_exit_page_title = event_data.page_data.page_title;\n          last_session.session_end_timestamp = event_data.event_timestamp;\n          if (last_session.cross_domain_session == 'No') {\n            last_session.cross_domain_session = (event_data.event_data.cross_domain_id) ? 'Yes' : 'No';\n          }\n\n          if (event_data.event_name == 'login') { last_session.user_id = last_session.user_id; }\n          if (event_data.event_name == 'logout') { last_session.user_id = null; }\n          last_session.total_events = last_session.total_events + 1;\n          if (event_data.event_name == 'page_view') { last_session.total_page_views = last_session.total_page_views + 1; }\n\n          // Send data to firestore                    \n          if (data.enable_logs) { log('👉 Payload to send: ', firestore_data); }\n\n          Firestore.write(document_path, firestore_data, { projectId: projectId, merge: true })\n            .then(\n              (id) => { if (data.enable_logs) { log('🟢 User already in Firestore, session successfully updated into Firestore'); } },\n              () => {\n                message = '🔴 User or session data not updated in Firestore.';\n                status_code = 403;\n\n                if (data.enable_logs) { log(message); }\n                return { status: false, status_code: status_code, message: message };\n              }\n            );\n\n          // Add data for BigQuery\n          event_data.session_data = last_session;\n          event_data.session_date = last_session.session_date;\n\n          Object.delete(event_data.session_data, 'session_date');\n          Object.delete(event_data.session_data, 'session_id');\n        }\n      }\n\n      return { status: true, status_code: 200, message: '🟢 Request claimed successfully' };\n    });\n}\n\n\n// Set user cookie\nfunction set_cookie(cookie_name, cookie_value, max_age) {\n  const cookie_domain = '.' + computeEffectiveTldPlusOne(request_origin);\n  const cookie_path = '/';\n  const cookie_secure = true;\n  const sameSite = \"Strict\";\n  const httpOnly = true;\n\n  const cookie_options = {\n    domain: cookie_domain,\n    path: cookie_path,\n    secure: cookie_secure,\n    sameSite: sameSite,\n    'max-age': max_age,\n    httpOnly: httpOnly\n  };\n\n  setCookie(cookie_name, cookie_value, cookie_options);\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Send data to Google BigQuery\nfunction send_to_bq(event_data) {\n  const payload_copy = JSON.parse(JSON.stringify(event_data));\n\n  if (data.enable_logs) { log('👉 Payload to send: ', payload_copy); }\n\n  // Encode data for Google BigQuery        \n  encode_data(payload_copy, 'user_data');\n  encode_data(payload_copy, 'session_data');\n  encode_data(payload_copy, 'page_data');\n  encode_data(payload_copy, 'event_data');\n  encode_data(payload_copy, 'consent_data');\n  encode_data(payload_copy, 'gtm_data');\n\n  payload_copy.datalayer = (payload_copy.datalayer) ? JSON.stringify(payload_copy.datalayer) : null;\n  payload_copy.ecommerce = (payload_copy.ecommerce) ? JSON.stringify(payload_copy.ecommerce) : null;\n\n  // Google BigQuery project settings\n  const project = {\n    projectId: data.bq_project_id,\n    datasetId: data.bq_dataset_id,\n    tableId: data.bq_table_id\n  };\n\n  // Write options\n  const options = {\n    skipInvalidRows: false,\n    ignoreUnknownValues: false\n  };\n\n  // Write to Google BigQuery\n  BigQuery.insert(project, [payload_copy], options,\n    () => { if (data.enable_logs) { log('🟢 Payload data inserted successfully into BigQuery'); } },\n    () => { if (data.enable_logs) { log('🔴 Payload data not inserted into BigQuery'); } }\n  );\n}\n\n\n// Encode event data\nfunction encode_data(bq_event_data, prop) {\n  if (bq_event_data[prop] && Object.keys(bq_event_data[prop]).length > 0) {\n    var mapped_data = [];\n    Object.keys(bq_event_data[prop]).forEach((key) => {\n      var temp_data = {};\n      // Is string \n      if (getType(bq_event_data[prop][key]) == 'string') {\n        temp_data.name = key;\n        temp_data.value = { string: bq_event_data[prop][key] || null };\n        // Is number (integer or float)    \n      } else if (getType(bq_event_data[prop][key]) == 'number') {\n        if (bq_event_data[prop][key] % 1 != 0) {\n          temp_data.name = key;\n          temp_data.value = { float: bq_event_data[prop][key] };\n        } else {\n          temp_data.name = key;\n          temp_data.value = { int: bq_event_data[prop][key] };\n        }\n        // Is JSON (object or array) \n      } else if (getType(bq_event_data[prop][key]) == 'object' || getType(bq_event_data[prop][key]) == 'array') {\n        temp_data.name = key;\n        temp_data.value = { json: JSON.stringify(bq_event_data[prop][key]) };\n\n        // Is null or undefined\n      } else if (getType(bq_event_data[prop][key]) == 'null' || getType(bq_event_data[prop][key]) == 'undefined') {\n        temp_data.name = key;\n        temp_data.value = null;\n        // Is boolean        \n      } else if (getType(bq_event_data[prop][key]) == 'boolean') {\n        temp_data.name = key;\n        temp_data.value = { bool: bq_event_data[prop][key] };\n      }\n      mapped_data.push(temp_data);\n    });\n    bq_event_data[prop] = mapped_data;\n  }\n}\n\n\n\n// ------------------------------------------------------------------------------------------------------------------------------------------------------\n\n\n\n// Send data to custom endpoint \nfunction send_to_custom_endpoint(custom_request_endpoint_path, event_data) {\n  if (data.enable_logs) { log('👉 Payload to send: ', event_data); }\n\n  const request_options = {\n    method: 'POST',\n    headers: {}\n  };\n\n  if (data.add_custom_request_headers) {\n    const custom_request_headers = data.custom_request_headers;\n\n    if (custom_request_headers !== undefined) {\n      for (let i = 0; i < custom_request_headers.length; i++) {\n        const header_name = custom_request_headers[i].header_name;\n        const header_value = custom_request_headers[i].header_value;\n\n        request_options.headers[header_name] = header_value;\n      }\n    }\n  }\n\n  sendHttpRequest(custom_request_endpoint_path, request_options, JSON.stringify(event_data))\n    .then((result) => {\n      if (result.statusCode >= 200 && result.statusCode < 300) {\n        if (data.enable_logs) { log('🟢 Request send succesfully to:', custom_request_endpoint_path); }\n      } else {\n        if (data.enable_logs) { log('🔴 Request do not send succesfully. Error:', result); }\n      }\n    });\n}\n\n\n___SERVER_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"read_request\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"requestAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        },\n        {\n          \"key\": \"headerAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        },\n        {\n          \"key\": \"queryParameterAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"return_response\",\n        \"versionId\": \"1\"\n      },\n      \"param\": []\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"run_container\",\n        \"versionId\": \"1\"\n      },\n      \"param\": []\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"logging\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"environments\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"debug\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"access_response\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"writeResponseAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        },\n        {\n          \"key\": \"writeHeaderAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"specific\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"access_bigquery\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"allowedTables\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 3,\n                \"mapKey\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"projectId\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"datasetId\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"tableId\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"operation\"\n                  }\n                ],\n                \"mapValue\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"write\"\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"read_container_data\",\n        \"versionId\": \"1\"\n      },\n      \"param\": []\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"get_cookies\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"cookieAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"set_cookies\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"allowedCookies\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 3,\n                \"mapKey\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"name\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"domain\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"path\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"secure\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"session\"\n                  }\n                ],\n                \"mapValue\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"any\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"any\"\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"access_firestore\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"allowedOptions\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 3,\n                \"mapKey\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"projectId\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"path\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"operation\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"databaseId\"\n                  }\n                ],\n                \"mapValue\": [\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"*\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"read_write\"\n                  },\n                  {\n                    \"type\": 1,\n                    \"string\": \"(default)\"\n                  }\n                ]\n              }\n            ]\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"send_http\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"allowedUrls\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios: []\nsetup: ''\n\n\n___NOTES___\n\n\n\n\n"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "templateId": "149",
                "name": "Restore url parameters",
                "fingerprint": "1757938738260",
                "templateData": "___INFO___\n\n{\n  \"type\": \"MACRO\",\n  \"id\": \"cvt_temp_public_id\",\n  \"version\": 1,\n  \"securityGroups\": [],\n  \"displayName\": \"Restore url parameters\",\n  \"description\": \"\",\n  \"containerContexts\": [\n    \"SERVER\"\n  ]\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[\n  {\n    \"type\": \"TEXT\",\n    \"name\": \"gclid_backup_param\",\n    \"displayName\": \"Gclid backup parameter\",\n    \"simpleValueType\": true,\n    \"help\": \"Parameter name from which gclid will be restored.\",\n    \"valueHint\": \"(not set)\",\n    \"alwaysInSummary\": true\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"settings\",\n    \"displayName\": \"Settings\",\n    \"groupStyle\": \"ZIPPY_OPEN_ON_PARAM\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"change_default_page_location_param\",\n        \"checkboxText\": \"Change default page location parameter\",\n        \"simpleValueType\": true,\n        \"subParams\": [\n          {\n            \"type\": \"TEXT\",\n            \"name\": \"page_location\",\n            \"displayName\": \"Page location parameter\",\n            \"simpleValueType\": true,\n            \"alwaysInSummary\": true,\n            \"valueHint\": \"page_location\",\n            \"enablingConditions\": [\n              {\n                \"paramName\": \"change_default_page_location_param\",\n                \"paramValue\": true,\n                \"type\": \"EQUALS\"\n              }\n            ],\n            \"valueValidators\": [\n              {\n                \"type\": \"NON_EMPTY\"\n              }\n            ]\n          }\n        ],\n        \"help\": \"Configure the default parameter name for the page location, retrieved from event data, which serves as the source for extracting query parameters.\\n\\u003c/br\\u003e\\u003c/br\\u003e\",\n        \"alwaysInSummary\": true\n      }\n    ]\n  }\n]\n\n\n___SANDBOXED_JS_FOR_SERVER___\n\nconst getEventData = require('getEventData');\nconst decodeUriComponent = require('decodeUriComponent');\nconst encodeUriComponent = require('encodeUriComponent');\nconst parseUrl = require('parseUrl');\nconst makeTableMap = require('makeTableMap');\nconst Object = require('Object');\nconst log = require('logToConsole');\n\n\n\n// const page_location = data.page_location || getEventData('page_location');\nconst page_location = data.page_location || 'https://tommasomoretti.com/tommi?gclid=1234&abcd=1234&utm_source=google&utm_mediu=organic';\nconst url = parseUrl(page_location);\n\nconst search_params = url.searchParams;\nconst gclid_backup_param = data.gclid_backup_param;\n\nif (!url.search) {\n  log('No search params');\n  return page_location;\n}\n\n\n// Loop per altri parametri\nif (!search_params.hasOwnProperty(\"gclid\") && search_params.hasOwnProperty(gclid_backup_param)) {\n  log('no gclid, si backup param');\n    \n  search_params.gclid = search_params[gclid_backup_param];\n  Object.delete(search_params, gclid_backup_param);\n  \n} else if (search_params.hasOwnProperty(\"gclid\") && search_params.hasOwnProperty(gclid_backup_param)) {\n  log('si gclid, si backup param');\n\n  Object.delete(search_params, gclid_backup_param);\n}\n\n// \n\nvar search = '?';\n\nfor (let key in search_params) {\n  search = search + key + '=' + search_params[key] + '&';\n }\n\nurl.search = search.slice(0, -1);\n\nreturn url.origin + url.pathname + url.search + url.hash;\n\n\n___SERVER_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"read_event_data\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"eventDataAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"any\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  },\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"logging\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"environments\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"debug\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios: []\n\n\n___NOTES___\n\nCreated on 15/09/2025, 13:56:47\n\n\n"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "templateId": "153",
                "name": "Query Replacer",
                "fingerprint": "1758640964071",
                "templateData": "___TERMS_OF_SERVICE___\n\nBy creating or modifying this file you agree to Google Tag Manager's Community\nTemplate Gallery Developer Terms of Service available at\nhttps://developers.google.com/tag-manager/gallery-tos (or such other URL as\nGoogle may provide), as modified from time to time.\n\n\n___INFO___\n\n{\n  \"type\": \"MACRO\",\n  \"id\": \"cvt_5NG8R\",\n  \"version\": 1,\n  \"displayName\": \"Query Replacer\",\n  \"description\": \"Replace query parameters in the page location.\",\n  \"containerContexts\": [\n    \"SERVER\"\n  ],\n  \"brand\": {\n    \"displayName\": \"stape-io\",\n    \"id\": \"github.com_stape-io\"\n  }\n}\n\n\n___TEMPLATE_PARAMETERS___\n\n[\n  {\n    \"type\": \"LABEL\",\n    \"name\": \"label\",\n    \"displayName\": \"Specify below which parameters in the \\u0027page_location\\u0027 Event Data variable should be replaced.\"\n  },\n  {\n    \"type\": \"SIMPLE_TABLE\",\n    \"name\": \"customParams\",\n    \"displayName\": \"\",\n    \"simpleTableColumns\": [\n      {\n        \"defaultValue\": \"\",\n        \"displayName\": \"replace this\",\n        \"name\": \"from\",\n        \"type\": \"TEXT\",\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\"\n          }\n        ],\n        \"isUnique\": true\n      },\n      {\n        \"defaultValue\": \"\",\n        \"displayName\": \"with this\",\n        \"name\": \"to\",\n        \"type\": \"TEXT\",\n        \"valueValidators\": [\n          {\n            \"type\": \"NON_EMPTY\"\n          }\n        ]\n      }\n    ],\n    \"valueValidators\": [\n      {\n        \"type\": \"NON_EMPTY\"\n      }\n    ]\n  },\n  {\n    \"type\": \"GROUP\",\n    \"name\": \"moreSettingsGroup\",\n    \"displayName\": \"More Settings\",\n    \"groupStyle\": \"ZIPPY_OPEN\",\n    \"subParams\": [\n      {\n        \"type\": \"CHECKBOX\",\n        \"name\": \"skipExisting\",\n        \"checkboxText\": \"Skip Existing Query Parameters\",\n        \"simpleValueType\": true,\n        \"help\": \"If the URL already contains a parameter matching one from the \\\"\\u003ci\\u003ewith this\\u003c/i\\u003e\\\" column, the parameter specified in the \\\"\\u003ci\\u003ereplace this\\u003c/i\\u003e\\\" will not be replaced.\"\n      }\n    ]\n  }\n]\n\n\n___SANDBOXED_JS_FOR_SERVER___\n\n/// <reference path=\"./server-gtm-sandboxed-apis.d.ts\" />\n\nconst getEventData = require('getEventData');\nconst decodeUriComponent = require('decodeUriComponent');\nconst encodeUriComponent = require('encodeUriComponent');\nconst parseUrl = require('parseUrl');\nconst makeTableMap = require('makeTableMap');\nconst getType = require('getType');\n\n/*==============================================================================\n==============================================================================*/\n\nconst pageLocation = getEventData('page_location');\nconst parsedUrl = parseUrl(pageLocation);\n\nif (!parsedUrl.search) return pageLocation;\n\nconst fromTo = makeTableMap(data.customParams, 'from', 'to');\nconst searchParams = parsedUrl.searchParams;\nconst newSearchParams = [];\n\n// 'fromKey' is always decoded.\nfor (const fromKey in searchParams) {\n  const value = searchParams[fromKey];\n\n  let toKey = decodeUriComponent(fromTo[fromKey] || fromTo[enc(fromKey)] || ''); // If the person added it either decoded or encoded.\n  if (data.skipExisting && searchParams.hasOwnProperty(toKey)) toKey = undefined;\n\n  const newKey = toKey ? toKey : fromKey;\n\n  getType(value) === 'array' // For parameters that are repeated.\n    ? value.forEach((v) => newSearchParams.push(enc(newKey) + '=' + enc(v)))\n    : newSearchParams.push(enc(newKey) + '=' + enc(value));\n}\n\nreturn (\n  parsedUrl.origin +\n  parsedUrl.pathname +\n  '?' +\n  newSearchParams.join('&') +\n  (parsedUrl.hash ? parsedUrl.hash : '')\n);\n\n/*==============================================================================\n  Helpers\n==============================================================================*/\n\nfunction enc(data) {\n  return encodeUriComponent(data || '');\n}\n\n\n___SERVER_PERMISSIONS___\n\n[\n  {\n    \"instance\": {\n      \"key\": {\n        \"publicId\": \"read_event_data\",\n        \"versionId\": \"1\"\n      },\n      \"param\": [\n        {\n          \"key\": \"keyPatterns\",\n          \"value\": {\n            \"type\": 2,\n            \"listItem\": [\n              {\n                \"type\": 1,\n                \"string\": \"page_location\"\n              }\n            ]\n          }\n        },\n        {\n          \"key\": \"eventDataAccess\",\n          \"value\": {\n            \"type\": 1,\n            \"string\": \"specific\"\n          }\n        }\n      ]\n    },\n    \"clientAnnotations\": {\n      \"isEditedByUser\": true\n    },\n    \"isRequired\": true\n  }\n]\n\n\n___TESTS___\n\nscenarios:\n- name: URL without parameters\n  code: |-\n    const decodeUriComponent = require('decodeUriComponent');\n\n    const mockData = {\n      customParams: [\n        { from: 'this', to: 'that' },\n        { from: 'foo', to: 'bar' },\n      ]\n    };\n\n    mock('getEventData', (key) => {\n      if (key === 'page_location') return page_location_without_query_params;\n    });\n\n    const variableResult = runCode(mockData);\n\n    assertThat(variableResult).isEqualTo(page_location_without_query_params);\n- name: URL with parameters and no modifications\n  code: |-\n    const decodeUriComponent = require('decodeUriComponent');\n\n    const mockData = {\n      customParams: [\n        { from: 'this', to: 'that' },\n        { from: 'foo', to: 'bar' },\n      ]\n    };\n\n    mock('getEventData', (key) => {\n      if (key === 'page_location') return page_location_with_query_params;\n    });\n\n    const variableResult = runCode(mockData);\n\n    assertThat(variableResult).isEqualTo('https://example.com/path/?oneparam=1%202%203%204&teste=123&anotherparam=hahsdhasd&anotherparam=repeated&par%C3%A2metro=%C3%A7%C3%A3o%3F1J23I12I3J#hash');\n- name: URL with parameters and no modifications (skipping existing query parameters)\n  code: |-\n    const decodeUriComponent = require('decodeUriComponent');\n\n    const mockData = {\n      customParams: [\n        { from: 'this', to: 'that' },\n        { from: 'foo', to: 'bar' },\n      ],\n      skipExisting: true\n    };\n\n    mock('getEventData', (key) => {\n      if (key === 'page_location') return page_location_with_query_params;\n    });\n\n    const variableResult = runCode(mockData);\n\n    assertThat(variableResult).isEqualTo('https://example.com/path/?oneparam=1%202%203%204&teste=123&anotherparam=hahsdhasd&anotherparam=repeated&par%C3%A2metro=%C3%A7%C3%A3o%3F1J23I12I3J#hash');\n- name: URL with parameters and with modifications\n  code: |\n    const decodeUriComponent = require('decodeUriComponent');\n\n    const mockData = {\n      customParams: [\n        { from: 'oneparam', to: 'new_one_param' },\n        { from: 'teste', to: 'new_teste' },\n        { from: 'par%C3%A2metro', to: 'testão' },\n      ]\n    };\n\n    mock('getEventData', (key) => {\n      if (key === 'page_location') return page_location_with_query_params;\n    });\n\n    const variableResult = runCode(mockData);\n\n    assertThat(variableResult).isEqualTo('https://example.com/path/?new_one_param=1%202%203%204&new_teste=123&anotherparam=hahsdhasd&anotherparam=repeated&test%C3%A3o=%C3%A7%C3%A3o%3F1J23I12I3J#hash');\n- name: URL with parameters and with modifications (skipping existing query parameters)\n  code: |\n    const decodeUriComponent = require('decodeUriComponent');\n\n    const mockData = {\n      customParams: [\n        { from: 'oneparam', to: 'anotherparam' },\n        { from: 'teste', to: 'new_teste' }\n      ],\n      skipExisting: true\n    };\n\n    mock('getEventData', (key) => {\n      if (key === 'page_location') return page_location_with_query_params;\n    });\n\n    const variableResult = runCode(mockData);\n\n    assertThat(variableResult).isEqualTo('https://example.com/path/?oneparam=1%202%203%204&new_teste=123&anotherparam=hahsdhasd&anotherparam=repeated&par%C3%A2metro=%C3%A7%C3%A3o%3F1J23I12I3J#hash');\nsetup: |-\n  const page_location_without_query_params = 'https://example.com/path/#hash';\n  const page_location_with_query_params = 'https://example.com/path/?oneparam=1%202%203%204&teste=123&anotherparam=hahsdhasd&par%C3%A2metro=%C3%A7%C3%A3o%3F1J23I12I3J&anotherparam=repeated#hash';\n\n\n___NOTES___\n\nCreated on 26/11/2024, 13:54:56\n\n\n",
                "galleryReference": {
                    "host": "github.com",
                    "owner": "stape-io",
                    "repository": "query-replacer-variable",
                    "version": "3ea7f72bbd7e7f533f20f8190556c338dae69cad",
                    "signature": "e8d2d3b2b211401d1538c6481954de7a74b2eae10b32100772726fc307e62a0e",
                    "galleryTemplateId": "5NG8R"
                }
            }
        ],
        "client": [
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "clientId": "9",
                "name": "GTM",
                "type": "gtm_client",
                "parameter": [
                    {
                        "type": "BOOLEAN",
                        "key": "activateResponseCompression",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "activateGeoResolution",
                        "value": "true"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "activateDependencyServing",
                        "value": "true"
                    },
                    {
                        "type": "LIST",
                        "key": "allowedContainerIds",
                        "list": [
                            {
                                "type": "MAP",
                                "map": [
                                    {
                                        "type": "TEMPLATE",
                                        "key": "containerId",
                                        "value": "GTM-PW7349P"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "region",
                        "value": "{{Visitor Region}}"
                    }
                ],
                "fingerprint": "1766832638808",
                "parentFolderId": "156"
            },
            {
                "accountId": "6000752942",
                "containerId": "47093634",
                "clientId": "128",
                "name": "NA",
                "type": "cvt_47093634_47",
                "parameter": [
                    {
                        "type": "TEMPLATE",
                        "key": "bq_table_id",
                        "value": "events_raw"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "add_authorized_domains",
                        "value": "true"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "override_user_id",
                        "value": "false"
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "bq_dataset_id",
                        "value": "nameless_analytics"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "add_session_parameters",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "change_cookie_prefix",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "remove_session_parameters",
                        "value": "false"
                    },
                    {
                        "type": "LIST",
                        "key": "banned_ips_list",
                        "list": [
                            {
                                "type": "MAP",
                                "map": [
                                    {
                                        "type": "TEMPLATE",
                                        "key": "banned_ip",
                                        "value": "193.71.159.53"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "change_default_session_duration",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "send_data_to_custom_endpoint",
                        "value": "false"
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "endpoint",
                        "value": "/tm/nameless"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "add_user_parameters",
                        "value": "false"
                    },
                    {
                        "type": "LIST",
                        "key": "authorized_domains_list",
                        "list": [
                            {
                                "type": "MAP",
                                "map": [
                                    {
                                        "type": "TEMPLATE",
                                        "key": "authorized_domain",
                                        "value": "tommasomoretti.com"
                                    }
                                ]
                            },
                            {
                                "type": "MAP",
                                "map": [
                                    {
                                        "type": "TEMPLATE",
                                        "key": "authorized_domain",
                                        "value": "namelessanalytics.com"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "type": "TEMPLATE",
                        "key": "bq_project_id",
                        "value": "tom-moretti"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "add_event_parameters",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "add_banned_ips",
                        "value": "true"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "enable_logs",
                        "value": "true"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "remove_user_parameters",
                        "value": "false"
                    },
                    {
                        "type": "BOOLEAN",
                        "key": "remove_event_parameters",
                        "value": "false"
                    }
                ],
                "fingerprint": "1766832638807",
                "parentFolderId": "156"
            }
        ]
    }
}